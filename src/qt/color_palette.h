#pragma once

#include <QColor>
#include <QMap>
#include <QException>

class UndefinedColorPalette : public QException {
public:
    void raise() const override { throw *this; }

    [[nodiscard]] UndefinedColorPalette *clone() const override {
        return new UndefinedColorPalette(*this);
    }
};

class ColorPalette {
public:
    ColorPalette();

    explicit ColorPalette(const QString &palette);

    explicit ColorPalette(const QList<QColor> &palette);

    [[nodiscard]] QString name() const noexcept;

    [[nodiscard]] QList<QColor> colors() const noexcept;

    [[nodiscard]] int size() const noexcept;

    [[nodiscard]] QColor at(int i) const noexcept;

    inline QColor operator[](int i) const noexcept {
        return at(i);
    }

    static inline const QMap<QString, QList<QColor>> SEABORN_PALETTES = {
            {"deep",        {0x4c72b0, 0xdd8452, 0x55a868, 0xc44e52, 0x8172b3, 0x937860, 0xda8bc3, 0x8c8c8c, 0xccb974, 0x64b5cd}},
            {"deep6",       {0x4c72b0, 0x55a868, 0xc44e52, 0x8172b3, 0xccb974, 0x64b5cd}},
            {"muted",       {0x4878d0, 0xee854a, 0x6acc64, 0xd65f5f, 0x956cb4, 0x8c613c, 0xdc7ec0, 0x797979, 0xd5bb67, 0x82c6e2}},
            {"muted6",      {0x4878d0, 0x6acc64, 0xd65f5f, 0x956cb4, 0xd5bb67, 0x82c6e2}},
            {"pastel",      {0xa1c9f4, 0xffb482, 0x8de5a1, 0xff9f9b, 0xd0bbff, 0xdebb9b, 0xfab0e4, 0xcfcfcf, 0xfffea3, 0xb9f2f0}},
            {"pastel6",     {0xa1c9f4, 0x8de5a1, 0xff9f9b, 0xd0bbff, 0xfffea3, 0xb9f2f0}},
            {"bright",      {0x023eff, 0xff7c00, 0x1ac938, 0xe8000b, 0x8b2be2, 0x9f4800, 0xf14cc1, 0xa3a3a3, 0xffc400, 0x00d7ff}},
            {"bright6",     {0x023eff, 0x1ac938, 0xe8000b, 0x8b2be2, 0xffc400, 0x00d7ff}},
            {"dark",        {0x001c7f, 0xb1400d, 0x12711c, 0x8c0800, 0x591e71, 0x592f0d, 0xa23582, 0x3c3c3c, 0xb8850a, 0x006374}},
            {"dark6",       {0x001c7f, 0x12711c, 0x8c0800, 0x591e71, 0xb8850a, 0x006374}},
            {"colorblind",  {0x0173b2, 0xde8f05, 0x029e73, 0xd55e00, 0xcc78bc, 0xca9161, 0xfbafe4, 0x949494, 0xece133, 0x56b4e9}},
            {"colorblind6", {0x0173b2, 0x029e73, 0xd55e00, 0xcc78bc, 0xece133, 0x56b4e9}},
    };

    static inline const QMap<QString, QList<QColor>> MPL_PERCEPTUALLY_UNIFORM_SEQUENTIAL_PALETTES = {
            {"rocket", {0x35193e, 0x701f57, 0xad1759, 0xe13342, 0xf37651, 0xf6b48f}},
            {"mako", {0x2e1e3b, 0x413d7b, 0x37659e, 0x348fa7, 0x40b7ad, 0x8bdab2}},
            {"flare", {0xe98d6b, 0xe3685c, 0xd14a61, 0xb13c6c, 0x8f3371, 0x6c2b6d}},
            {"crest", {0x7dba91, 0x59a590, 0x40908e, 0x287a8c, 0x1c6488, 0x254b7f}},
            {"viridis", {0x46327e, 0x365c8d, 0x277f8e, 0x1fa187, 0x4ac16d, 0xa0da39}},
            {"plasma", {0x5302a3, 0x8b0aa5, 0xb83289, 0xdb5c68, 0xf48849, 0xfebd2a}},
            {"inferno", {0x280b53, 0x65156e, 0x9f2a63, 0xd44842, 0xf57d15, 0xfac228}},
            {"magma", {0x221150, 0x5f187f, 0x982d80, 0xd3436e, 0xf8765c, 0xfebb81}},
            {"cividis", {0x213b6e, 0x4c556c, 0x6c6e72, 0x8e8978, 0xb1a570, 0xd9c55c}},
    };

    static inline const QMap<QString, QList<QColor>> MPL_SEQUENTIAL_PALETTES = {
            {"Greys",   {0xededed, 0xd1d1d1, 0xadadad, 0x828282, 0x5c5c5c, 0x2b2b2b}},
            {"Purples", {0xecebf4, 0xd1d2e7, 0xafaed4, 0x8d89c0, 0x705eaa, 0x572c92}},
            {"Blues",   {0xdbe9f6, 0xbad6eb, 0x89bedc, 0x539ecd, 0x2b7bba, 0x0b559f}},
            {"Greens",  {0xe1f3dc, 0xbce4b5, 0x8ed08b, 0x56b567, 0x2c944c, 0x05712f}},
            {"Oranges", {0xfee3c8, 0xfdc692, 0xfda057, 0xf67824, 0xe05206, 0xad3803}},
            {"Reds",    {0xfedbcc, 0xfcaf93, 0xfc8161, 0xf44f39, 0xd52221, 0xaa1016}},
            {"YlOrBr",  {0xfff4b6, 0xfeda7e, 0xfeb23f, 0xf4811d, 0xd55607, 0xa03704}},
            {"YlOrRd",  {0xffea9b, 0xfece6a, 0xfea245, 0xfc6832, 0xea2920, 0xc20325}},
            {"OrRd",    {0xfee5c3, 0xfdcd96, 0xfda872, 0xf4764f, 0xde3f2b, 0xb80604}},
            {"PuRd",    {0xe5dcec, 0xd1aed4, 0xd280bd, 0xe4429a, 0xd51965, 0x9f0245}},
            {"RdPu",    {0xfdddd9, 0xfbbabd, 0xf988ad, 0xe84a9b, 0xbc1085, 0x810178}},
            {"BuPu",    {0xdce9f2, 0xb5cce3, 0x96acd2, 0x8c7dba, 0x894da3, 0x821580}},
            {"GnBu",    {0xddf2d8, 0xc2e7c0, 0x95d6bb, 0x61bdcd, 0x3597c4, 0x0d6dae}},
            {"PuBu",    {0xe8e4f0, 0xc4cbe3, 0x91b5d6, 0x509ac6, 0x1379b5, 0x045d92}},
            {"YlGnBu",  {0xe8f6b1, 0xb2e1b6, 0x65c3bf, 0x2ca1c2, 0x216daf, 0x253997}},
            {"PuBuGn",  {0xe8e0ef, 0xc4cbe3, 0x8cb5d6, 0x4b9ac6, 0x11859a, 0x016f5f}},
            {"BuGn",    {0xe2f4f7, 0xbde6de, 0x84cfb9, 0x51b689, 0x2c9553, 0x05712f}},
            {"YlGn",    {0xf3fab6, 0xccea9d, 0x97d385, 0x58b669, 0x2c8f4b, 0x056c39}},
    };

    static inline const QMap<QString, QList<QColor>> MPL_SEQUENTIAL2_PALETTES = {
            {"binary",    {0xdbdbdb, 0xb6b6b6, 0x929292, 0x6d6d6d, 0x494949, 0x242424}},
            {"gist_yarg", {0xdbdbdb, 0xb6b6b6, 0x929292, 0x6d6d6d, 0x494949, 0x242424}},
            {"gist_gray", {0x242424, 0x494949, 0x6d6d6d, 0x929292, 0xb6b6b6, 0xdbdbdb}},
            {"gray",      {0x242424, 0x494949, 0x6d6d6d, 0x929292, 0xb6b6b6, 0xdbdbdb}},
            {"bone",      {0x201f2c, 0x404059, 0x5f657f, 0x8091a0, 0x9fbcbf, 0xcee0df}},
            {"pink",      {0x7b4e4e, 0xac6f6f, 0xc99588, 0xd8bf9e, 0xe5e1b0, 0xf3f3d8}},
            {"spring",    {0xff24db, 0xff49b6, 0xff6d92, 0xff926d, 0xffb649, 0xffdb24}},
            {"summer",    {0x249266, 0x49a466, 0x6db666, 0x92c866, 0xb6db66, 0xdbed66}},
            {"autumn",    {0xff2400, 0xff4900, 0xff6d00, 0xff9200, 0xffb600, 0xffdb00}},
            {"winter",    {0x0024ed, 0x0049db, 0x006dc8, 0x0092b6, 0x00b6a4, 0x00db92}},
            {"cool",      {0x24dbff, 0x49b6ff, 0x6d92ff, 0x926dff, 0xb649ff, 0xdb24ff}},
            {"Wistia",    {0xf3f244, 0xffe216, 0xffc908, 0xffb500, 0xffa400, 0xfe9200}},
            {"hot",       {0x690000, 0xca0000, 0xff2a00, 0xff8b00, 0xffe900, 0xffff71}},
            {"afmhot",    {0x480000, 0x921200, 0xda5a00, 0xffa425, 0xffec6d, 0xffffb7}},
            {"gist_heat", {0x360000, 0x6e0000, 0xa30000, 0xdb2500, 0xff6d00, 0xffb76f}},
            {"copper",    {0x2c1c12, 0x5a3924, 0x875536, 0xb47249, 0xe18e5b, 0xffab6d}},
    };

    static inline const QMap<QString, QList<QColor>> MPL_DIVERGING_PALETTES = {
            {"PiYG",     {0xcf4191, 0xeeadd4, 0xfbe6f1, 0xebf6db, 0xb0dc7d, 0x62a32e}},
            {"PRGn",     {0x844793, 0xbc9eca, 0xebdeec, 0xe1f2dd, 0x9cd597, 0x358e48}},
            {"BrBG",     {0xa16518, 0xdbb972, 0xf6ecd1, 0xd4ede9, 0x76c6ba, 0x167a72}},
            {"PuOr",     {0xc6690c, 0xf9b158, 0xfce6c8, 0xe1e2ee, 0xaba3cd, 0x664697}},
            {"RdGy",     {0xc13639, 0xf09c7b, 0xfee5d6, 0xe9e9e9, 0xb3b3b3, 0x656565}},
            {"RdBu",     {0xc13639, 0xf09c7b, 0xfbe3d4, 0xdbeaf2, 0x87beda, 0x2f79b5}},
            {"RdYlBu",   {0xe34933, 0xfca55d, 0xfee99d, 0xe9f6e8, 0xa3d3e6, 0x588cc0}},
            {"RdYlGn",   {0xe34933, 0xfca55d, 0xfee999, 0xe3f399, 0x9dd569, 0x39a758}},
            {"Spectral", {0xe2514a, 0xfca55d, 0xfee999, 0xedf8a3, 0xa2d9a4, 0x47a0b3}},
            {"coolwarm", {0x6788ee, 0x9abbff, 0xc9d7f0, 0xedd1c2, 0xf7a889, 0xe26952}},
            {"bwr",      {0x4848ff, 0x9292ff, 0xdadaff, 0xffdada, 0xff9292, 0xff4848}},
            {"seismic",  {0x0000b1, 0x2525ff, 0xb5b5ff, 0xffb5b5, 0xff2525, 0xc80000}},
    };

    static inline const QMap<QString, QList<QColor>> MPL_CYCLIC_PALETTES = {
            {"twilight",         {0x89adc5, 0x5f61b4, 0x491564, 0x501444, 0xa54350, 0xca997c}},
            {"twilight_shifted", {0x5c359a, 0x6989be, 0xbccbd1, 0xd6c2b6, 0xbc6b59, 0x7f2350}},
            {"hsv",              {0xffd500, 0x4fff00, 0x00ff86, 0x009eff, 0x3700ff, 0xff00ed}},
    };

    static inline const QMap<QString, QList<QColor>> MPL_QUAL_PALETTES = {
            {"tab10",   {0x1f77b4, 0xff7f0e, 0x2ca02c, 0xd62728, 0x9467bd, 0x8c564b, 0xe377c2, 0x7f7f7f, 0xbcbd22, 0x17becf}},
            {"tab20",   {0x1f77b4, 0xaec7e8, 0xff7f0e, 0xffbb78, 0x2ca02c, 0x98df8a, 0xd62728, 0xff9896, 0x9467bd, 0xc5b0d5, 0x8c564b, 0xc49c94, 0xe377c2, 0xf7b6d2, 0x7f7f7f, 0xc7c7c7, 0xbcbd22, 0xdbdb8d, 0x17becf, 0x9edae5}},
            {"tab20b",  {0x393b79, 0x5254a3, 0x6b6ecf, 0x9c9ede, 0x637939, 0x8ca252, 0xb5cf6b, 0xcedb9c, 0x8c6d31, 0xbd9e39, 0xe7ba52, 0xe7cb94, 0x843c39, 0xad494a, 0xd6616b, 0xe7969c, 0x7b4173, 0xa55194, 0xce6dbd, 0xde9ed6}},
            {"tab20c",  {0x3182bd, 0x6baed6, 0x9ecae1, 0xc6dbef, 0xe6550d, 0xfd8d3c, 0xfdae6b, 0xfdd0a2, 0x31a354, 0x74c476, 0xa1d99b, 0xc7e9c0, 0x756bb1, 0x9e9ac8, 0xbcbddc, 0xdadaeb, 0x636363, 0x969696, 0xbdbdbd, 0xd9d9d9}},
            {"Set1",    {0xe41a1c, 0x377eb8, 0x4daf4a, 0x984ea3, 0xff7f00, 0xffff33, 0xa65628, 0xf781bf, 0x999999}},
            {"Set2",    {0x66c2a5, 0xfc8d62, 0x8da0cb, 0xe78ac3, 0xa6d854, 0xffd92f, 0xe5c494, 0xb3b3b3}},
            {"Set3",    {0x8dd3c7, 0xffffb3, 0xbebada, 0xfb8072, 0x80b1d3, 0xfdb462, 0xb3de69, 0xfccde5, 0xd9d9d9, 0xbc80bd, 0xccebc5, 0xffed6f}},
            {"Accent",  {0x7fc97f, 0xbeaed4, 0xfdc086, 0xffff99, 0x386cb0, 0xf0027f, 0xbf5b17, 0x666666}},
            {"Paired",  {0xa6cee3, 0x1f78b4, 0xb2df8a, 0x33a02c, 0xfb9a99, 0xe31a1c, 0xfdbf6f, 0xff7f00, 0xcab2d6, 0x6a3d9a, 0xffff99, 0xb15928}},
            {"Pastel1", {0xfbb4ae, 0xb3cde3, 0xccebc5, 0xdecbe4, 0xfed9a6, 0xffffcc, 0xe5d8bd, 0xfddaec, 0xf2f2f2}},
            {"Pastel2", {0xb3e2cd, 0xfdcdac, 0xcbd5e8, 0xf4cae4, 0xe6f5c9, 0xfff2ae, 0xf1e2cc, 0xcccccc}},
            {"Dark2",   {0x1b9e77, 0xd95f02, 0x7570b3, 0xe7298a, 0x66a61e, 0xe6ab02, 0xa6761d, 0x666666}},
    };

    static inline const QMap<QString, QList<QColor>> MPL_MISC_PALETTES = {
            {"flag",          {0xfffbee, 0x0000ff, 0x000008, 0xff1c08, 0xffffff, 0x0000ee}},
            {"prism",         {0x3aef00, 0xff000f, 0x42f400, 0xff001e, 0x4bfa00, 0xff002c}},
            {"ocean",         {0x004a24, 0x001249, 0x00246d, 0x005b92, 0x2492b6, 0x93c9db}},
            {"gist_earth",    {0x184179, 0x30817e, 0x419552, 0x82a954, 0xb9b35f, 0xd5b194}},
            {"terrain",       {0x0393f9, 0x25d36d, 0xb5f08a, 0xdad085, 0x92735e, 0xb7a39f}},
            {"gist_stern",    {0x912448, 0x494992, 0x6d6dda, 0x9292b0, 0xb6b617, 0xdbdb77}},
            {"gnuplot",       {0x6001c6, 0x8806f8, 0xa71470, 0xc13000, 0xd75d00, 0xeca200}},
            {"gnuplot2",      {0x000090, 0x1d00ff, 0x8d04fb, 0xff4eb1, 0xff9669, 0xffe01f}},
            {"CMRmap",        {0x2b2688, 0x632aad, 0xc4385a, 0xf06510, 0xe6ad12, 0xe6e172}},
            {"cubehelix",     {0x1a2441, 0x1b6145, 0x697b30, 0xc87b7c, 0xcda2e0, 0xc6e1f1}},
            {"brg",           {0x4800b7, 0x92006d, 0xda0025, 0xda2500, 0x926d00, 0x48b700}},
            {"gist_rainbow",  {0xff9900, 0x9dff00, 0x00ff26, 0x00ffed, 0x004eff, 0x7b00ff}},
            {"rainbow",       {0x386df9, 0x12c8e6, 0x5af8c8, 0xa4f89f, 0xecc86f, 0xff6d38}},
            {"turbo",         {0x4776ee, 0x1bd0d5, 0x61fc6c, 0xd2e935, 0xfe9b2d, 0xda3907}},
            {"nipy_spectral", {0x1800a7, 0x0090dd, 0x00a13d, 0x00ec00, 0xf3e500, 0xf90000}},
            {"gist_ncar",     {0x007fff, 0x00fc5e, 0x84ff0c, 0xffdf00, 0xff2600, 0xb044fa}},
    };

    static inline QList<QMap<QString, QList<QColor>>> ALL_PALETTES = {
            SEABORN_PALETTES,
            MPL_PERCEPTUALLY_UNIFORM_SEQUENTIAL_PALETTES,
            MPL_SEQUENTIAL_PALETTES,
            MPL_SEQUENTIAL2_PALETTES,
            MPL_DIVERGING_PALETTES,
            MPL_CYCLIC_PALETTES,
            MPL_QUAL_PALETTES,
            MPL_MISC_PALETTES,
    };

protected:
    QString name_;
    QList<QColor> colors_;
};
